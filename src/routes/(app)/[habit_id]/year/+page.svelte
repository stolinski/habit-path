<script lang="ts">
	import { format_mmdd } from '$lib/utils.js';
	const { data } = $props();

	// Year in, all iso date strings of year out
	function getAllDaysInYear(year: number): string[] {
		const daysInYear = [];
		const startDate = Temporal.PlainDate.from({ year, month: 1, day: 1 });
		const endDate = Temporal.PlainDate.from({ year, month: 12, day: 31 });

		let currentDate = startDate;
		while (Temporal.PlainDate.compare(currentDate, endDate) <= 0) {
			daysInYear.push(currentDate.toString());
			currentDate = currentDate.add({ days: 1 });
		}

		return daysInYear;
	}

	const year: number = 2024;
	const daysOfYear: string[] = getAllDaysInYear(year);
</script>

<a href="/">Back</a>
<h1>{data.habit.name}</h1>
<div class="grid" style:--habit_color="#a0dcc8" style:--habit_fg="oklch(0 0 0 / 70%)">
	{#each daysOfYear as day}
		<button class:complete={data.habit.checks.includes(day)} class="daily_button"
			>{format_mmdd(day)}</button
		>
	{/each}
</div>

<style>
	.grid {
		display: grid;
		grid-template-columns: repeat(auto-fill, 80px);
		gap: 10px;
	}

	.daily_button {
		opacity: 0.5;
		flex-shrink: 0;
		border-radius: 0;
		cursor: default;
		border: 0;
		height: 40px;
		color: #999;
		font-weight: 400;
		flex: 1;
		transition: 0.2s ease-in-out all;
		position: relative;
		background: var(--shade);
		overflow: hidden;
		font-size: var(--font-size-sm);
		border-radius: 2px;
	}

	.complete {
		opacity: 1;
		background-color: var(--habit_color);
		border: none;
		color: var(--habit_fg);
		border: solid 0.5px var(--tint);
		box-shadow:
			2px 2px 5px rgba(0, 0, 0, 0.1) inset,
			1px 1px 2px rgba(0, 0, 0, 0.3) inset;
		position: relative;
	}

	.complete::after {
		content: '';
		position: absolute;
		inset: 0;
		mix-blend-mode: multiply;
		opacity: 0.1;
		background-image: linear-gradient(115deg, #000, #fff);
	}
</style>
